<div class="col-lg-12 share-location">
    <h2>Share Your Location</h2>

    <button class="btn" onclick="sendLocation()">Share My Location</button>
</div>

<script type="text/javascript">
    function sendLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                fetch('/Location/SaveLocation', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude
                    })
                })
                .then(response => {
                    if (response.ok) {
                        alert("Location sent to server. You will now be redirected to your area's results.");
                        window.location.href = '/Species/Index';
                    } else {
                        alert("Failed to send location to server.");
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("An error occurred while sending the location.");
                });
            });
        } else {
            alert("Geolocation is not supported by this browser.");
        }
    }
</script>
